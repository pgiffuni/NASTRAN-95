SUBROUTINE inptt4
     
!     THIS INPTT4 UTILITY MODULE WILL READ USER-SUPPLIED TAPE (OR DISC
!     FILE), AS GENERATED FROM OUTPUT4 OR FROM MSC/OUTPUTi MODULES (i=1,
 
!     THIS MODULE HANDLES ONLY MATRICES, AND NOT TABLES
 
!     COSMIC/OUTPUT4 AND MSC/OUTPUT4 ARE IDENTICAL (BINARY ONLY)
!     COSMIC/INPUTT4 AND MSC/INPUTT4 ARE SIMILAR, EXECPT COSMIC/INPUTT4
!     CAN ALSO PROCESS MSC/OUTPUT1 AND MSC/OUTPUT2 TAPES.
 
!     INPUTT4   /O1,O2,O3,O4,O5/V,N,P1/V,N,P2/V,N,P3/V,N,P4 $
 
!        Oi     = OUTPUT GINO DATA BLOCKS
 
!        P1     = TAPE READ POSITION CONTROL
!               . SEE P1 OF INPUTT1 MODULE IF P4=-1
!               . SEE P1 OF INPUTT2 MODULE IF P4=-2
!               . SEE P1 OF INPUTT4 MODULE IF P4=-4
!               . IF P4=0,   P1= 0 NO ACTION
!                            P1=-1 REWIND P2 BEFORE READ
!                            P1=-2 WRITE E-O-F MARK AND REWIND P2 AT END
!                            P1=-3 BOTH
!        P2     =+N, INPUT TAPE LOGICAL UNIT, INTEGER, NO DEFAULT
!                    INPUT TAPE IS IN BINARY (UNFORMATTED).
!               =-N, INPUT TAPE LOGICAL UNIT +N, INPUT MATRICES WERE
!                    WRITTEN IN BCD RECORDS (i.e. ASCII, FORMATTED)
!        P3     = TAPE LABEL, DEFAULT='XXXXXXXX'
!        P4     = OUTPUT TAPE MODULE, INTEGER (DEFAULT P4=0)
!               =-4, TAPE WAS ORIGINALLY WRITTEN BY MSC/OUTPUT4 MODULE*
!                    UNFORMATTED (BINARY) TAPE, OR FORMATTED (BCD) TAPE.
!                    FORMATS FOR BCD TAPE ARE -
!                    3I8 FOR INTEGERS, 2A4 FOR BCD, AND 5E16.9 FOR REAL.
!               =-2, TAPE WAS ORIGINALLY WRITTEN BY MSC/OUTPUT2 MODULE*
!               =-1, TAPE WAS ORIGINALLY WRITTEN BY MSC/OUTPUT1 MODULE*
!               = 0, TAPE WAS ORIGINALLY WRITTEN BY OUTPUT4 MODULE
!                 .  IN BINARY RECORDS (P2=+N), UNFORMATTED.
!                 .  IN ASCII FORMATTED RECORDS (P2=-N), FORMATS FOR
!                    INTEGERS AND REAL DATA ARE MATRIX TYPE DEPENDENT.
!                    I13 AND 10E13.6 FOR S.P.MATRIX DATA, AND
!                    I16 AND  8D16.9 FOR D.P.MATRIX DATA.
!                    I16 AND  8E16.9 FOR S.P.MATRIX DATA, AND LONG WORD
!             .GE.1, IN ASCII FORMATTED RECORDS (P2=-N), I16 IS USED FOR
!                    INTEGERS, AND 8E16.9 FOR ALL REAL S.P. OR D.P.DATA
 
!        * REQUIRE SYNCHRONIZED GINO BUFFER SIZE IN COSMIC NASTRAN AND
!          MSC/NASTRAN
 
!     PARAMETERS EQUIVALENCE FOR COSMIC/INPUTT4 AND MSC/INPUTT4
 
!          COSMIC/INPUTT4        MSC/INPUTT4
!          --------------        ------------------------------
!               P1               NMAT (NO OF MATRICES ON TAPE)
!               P2               P2
!               P3               P1
!               P4               BCDOPT
 
 
!     NOTE - MIXED OUTPUT FILES FROM MSC/OUTPUT1, OUTPUT2 AND OUTPUT4
!            ON ONE TAPE ARE NOT ALLOWED IN THIS INPUTT4 MODULE
 
!     EXAMPLE 1 - INPUT TAPE INP1 (UNIT 15) CONTAINS 5 MATRICES,
!     =========   WRITTEN BY OUTPUT4, BINARY.
!                 WE WANT TO COPY
!                 FILE 3 TO A,
!                 FILE 4 TO B
 
!     1.  INPUTT4  /,,A,B,/-1/15   $ REWIND, READ & ECHO HEADER RECORD
 
 
!     EXAMPLE 2 - TO COPY THE FIRST 2 FILES OF A FORMATTED TAPE INP2
!     =========   (UNIT 16), WRITTEN BY OUTPUT4
 
!     2.  INPUTT4  /A,B,,,/-1/-16  $
 
 
!     EXAMPLE 3 - TO LIST THE FILES ON INP3 (TAPE CODE 3), THEN REWIND,
!     =========   AND COPY FILES 2 AND 3 ON INPUT TAPE ORIGINALLY
!                 WRITTEN BY MSC/OUTPUT1. TAPE CONTAINS A HEADER RECORD
!                 (FILE 0), AND TAPE ID "MYFILE"
 
!     3.  INPUTT4  /A,B,,,/-3/3/*MYFILE*/-1  $
 
!     ACTUALLY, INPTT4 MODULE CALLS INPUT2 TO PROCESS ANY TAPE THAT WAS
!     GENERATED BY MSC/OUTPUT2. SIMILARILY, INPUT1 IS CALLED FOR TAPE
!     FROM MSC/OUTPUT1
 
!     THE FIRT PARAMETER NMAT IN MSC/INPUTT4 IS NOT USED HERE
 
 INTEGER :: p1,p2,p3,p4,bcdopt,y(1),z(1)
 COMMON /BLANK / p1,p2,p3(2),p4
 COMMON /system/ ibuff,nout
 COMMON /zzzzzz/ x(1)
 EQUIVALENCE     (y(1),x(1))
 EQUIVALENCE     (z(1),x(1))
 
 IF (p4 >= 0) GO TO 40
 nmat = IABS(p4)
 SELECT CASE ( nmat )
   CASE (    1)
     GO TO 10
   CASE (    2)
     GO TO 20
   CASE (    3)
     GO TO 30
   CASE (    4)
     GO TO 40
   CASE (    5)
     GO TO 30
 END SELECT
 
 10 CALL input1
 GO TO 50
 
 20 CALL input2
 GO TO 50
 
 30 WRITE  (nout,35) p4
 35 FORMAT ('  ERROR IN INPTT4.  P4 =',i3,' NOT AVAILABLE')
 CALL mesage (-61,0,0)
 
 40 nmat  = 5
 iunit = IABS(p2)
 itape = p1
 bcdopt= 1
 IF (p2 < 0) bcdopt = 2
 IF (p4 > 0) bcdopt = 3
 
!     BCDOPT = 1, BINARAY INPUT TAPE
!            = 2, ASCII INPUT TAPE, WITH S.P./D.P. STANDARD FORMATS
!            = 3, ASCII INPUT TAPE, WITH LARGE FILED S.P./D.P. FORMATS
 
 CALL input4 (nmat,iunit,itape,bcdopt)
 50 RETURN
END SUBROUTINE inptt4
