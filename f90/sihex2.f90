SUBROUTINE sihex2 (TYPE,gpt,nip,strspt,istore)
     
!     PHASE 2 STRESS DATA RECOVERY FOR IHEX1, IHEX2, AND IHEX3 ELEMENTS
 
!           TYPE = 1    IHEX1
!           TYPE = 2    IHEX2
!           TYPE = 3    IHEX3
 
!***********************************************************************
 
!     ARRAY ESTA CONTAINS THE FOLLOWING WHERE NGP IS THE NUMBER OF
!     GRID POINTS
 
!           ELEMENT ID
!           NGP SIL NUMBERS
!           NGP VALUES OF THE SHAPE FUNCTIONS AT THIS STRESS POINT
!           REFERENCE TEMPERATURE
!           6 THERMAL STRESS COEFFICIENTS
!           NGP 6 BY 3 MATRICES RELATING STRESS TO DISPLACEMENTS
!                 AT THIS STRESS POINT (STORED ROW-WISE)
 
!     PHIOUT STARTS AT ESTA(101)
 
!***********************************************************************
 
 
 
 INTEGER, INTENT(IN)                      :: TYPE
 REAL, INTENT(IN)                         :: gpt(1)
 INTEGER, INTENT(OUT)                     :: nip
 INTEGER, INTENT(OUT)                     :: strspt
 INTEGER, INTENT(OUT)                     :: istore
 INTEGER :: iesta(1)   ,istrs(11)  ,  &
     sil         ,oldeid     ,eqexin     ,extrnl(32) ,  &
     equ         ,ifrvec(11) ,eject      ,ishd(7)    , typ(4)      ,dummy
 
 REAL :: stress(10) ,sigp(3)    ,smat(3,3)  , csig(6)     ,frlast(2)
 REAL :: store(384)  ,sigs(126)  ,csigs(126)
 DIMENSION  ex20g3(567) ,ex2031(132),ex2032(127),ex2033(127),  &
     ex2034(127) ,ex2035(54)
 DIMENSION  ex8g3(243)  ,ex8g31(132),ex8g32(111)
 DIMENSION  ex20g2(168) ,ex2021(152),ex2022(16)
 DIMENSION  ex8g2(72)
 DIMENSION  ex8g4(576)  ,ex8g41(152),ex8g42(152),ex8g43(152), ex8g44(120)
 DIMENSION  ex20g4(1344),ex2041(152),ex2042(152),ex2043(152),  &
     ex2044(152) ,ex2045(152),ex2046(152),ex2047(152), ex2048(152) ,ex2049(128)
 
 COMMON /system/ ibfsz  ,nout       ,idm(9)     ,line
 
 COMMON /zzzzzz/ z(1)
 
 COMMON /sdr2x2/ bbb(4) ,eqexin
 
 COMMON /sdr2x4/ ccc(35),ivec       ,ivecn       ,  &
     jtemp  ,ddd(13)    ,ktype       ,skip(56)   , isopl
 
 COMMON /sdr2x7/ esta(649)
 
 COMMON /sdr2x8/ iend   ,dummy(32)  ,sig(6)      ,  &
     strspx ,ngp        ,leqx        , neqx   ,ipts       ,mxleq       ,  &
     l      ,i          ,j           , sil    ,klo        ,khi         ,  &
     k      ,kx         ,temp        , sa     ,sb         ,sc          ,  &
     sn     ,so         ,p           , q      ,r          ,a           ,  &
     b      ,phi        ,x           , cosphi ,s          ,t           ,  &
     v      ,DCOS(3,3)  ,rm          , rx     ,ry         ,rz          ,  &
     rxy    ,ryz        ,rzx         , itrl(7),equ(200)
 COMMON /sdr2x9/ nchk   ,isub       ,ild         ,  &
     frtmei(2)          ,twotop      , fnchk
!     COMMON /SDRETT/ DUM(9) ,OLDEID
 
 
 EQUIVALENCE     (iesta(1),esta(1)) ,(stress(1),istrs(1),esta(101))
 
 EQUIVALENCE     (sigp(1), sa)      ,(sig(1) , sx),  &
     (sig(2) , sy)      ,(sig(3) , sz), (sig(4) ,sxy)      ,(sig(5) ,syz),  &
     (sig(6) ,szx)      ,(csig(1),ifrvec(6))
 
 EQUIVALENCE     (lsub,ishd(1))     ,(lld ,ishd(2)), (frlast(1),ishd(6))
 EQUIVALENCE     (ex20g3(  1),ex2031(1)),(ex20g3(133),ex2032(1)),  &
     (ex20g3(260),ex2033(1)),(ex20g3(387),ex2034(1)), (ex20g3(514),ex2035(1))
 EQUIVALENCE     (ex8g3(   1),ex8g31(1)),(ex8g3( 133),ex8g32(1))
 EQUIVALENCE     (ex20g2(  1),ex2021(1)),(ex20g2(153),ex2022(1))
 EQUIVALENCE     (ex8g4(   1),ex8g41(1)),(ex8g4( 153),ex8g42(1)),  &
     (ex8g4( 305),ex8g43(1)),(ex8g4( 457),ex8g44(1))
 EQUIVALENCE     (ex20g4(  1),ex2041(1)),(ex20g4(153),ex2042(1)),  &
     (ex20g4(305),ex2043(1)),(ex20g4(457),ex2044(1)),  &
     (ex20g4(609),ex2045(1)),(ex20g4(761),ex2046(1)),  &
     (ex20g4(913),ex2047(1)),(ex20g4(1065),ex2048(1)), (ex20g4(1217),ex2049(1))
 DATA ex8g2/  &
     -.0490,  .1830,  .1830, -.6830,  .1830, -.6830, -.6830, 2.5490,  &
     .1830, -.6830, -.6830, 2.5490, -.0490,  .1830,  .1830, -.6830,  &
     -.6830, 2.5490,  .1830, -.6830,  .1830, -.6830, -.0490,  .1830,  &
     .1830, -.6830, -.0490,  .1830, -.6830, 2.5490,  .1830, -.6830,  &
     .1830, -.0490, -.6830,  .1830, -.6830,  .1830, 2.5490, -.6830,  &
     -.6830,  .1830, 2.5490, -.6830,  .1830, -.0490, -.6830,  .1830,  &
     2.5490, -.6830, -.6830,  .1830, -.6830,  .1830,  .1830, -.0490,  &
     -.6830,  .1830,  .1830, -.0490, 2.5490, -.6830, -.6830,  .1830,  &
     .1250,  .1250,  .1250,  .1250,  .1250,  .1250,  .1250,  .1250/
 DATA ex8g31/  &
     .0066, -.0235,  .0522, -.0235,  .0835, -.1852,  .0522, -.1852,  &
     .4108, -.0235,  .0835, -.1852,  .0835, -.2963,  .6573, -.1852,  &
     .6573,-1.4580,  .0522, -.1852,  .4108, -.1852,  .6573,-1.4580,  &
     .4108,-1.4580, 3.2341,  &
     .0522, -.1852,  .4108, -.1852,  .6573,-1.4580,  .4108,-1.4580,  &
     3.2341, -.0235,  .0835, -.1852,  .0835, -.2963,  .6573, -.1852,  &
     .6573,-1.4580,  .0066, -.0235,  .0522, -.0235,  .0835, -.1852,  &
     .0522, -.1852,  .4108,  &
     .4108,-1.4580, 3.2341, -.1852,  .6573,-1.4580,  .0522, -.1852,  &
     .4108, -.1852,  .6573,-1.4580,  .0835, -.2963,  .6573, -.0235,  &
     .0835, -.1852,  .0522, -.1852,  .4108, -.0235,  .0835, -.1852,  &
     .0066, -.0235,  .0522,  &
     .0522, -.1852,  .4108, -.0235,  .0835, -.1852,  .0066, -.0235,  &
     .0522, -.1852,  .6573,-1.4580,  .0835, -.2963,  .6573, -.0235,  &
     .0835, -.1852,  .4108,-1.4580, 3.2341, -.1852,  .6573,-1.4580,  &
     .0522, -.1852,  .4108,  &
     .0522, -.0235,  .0066, -.1852,  .0835, -.0235,  .4108, -.1852,  &
     .0522, -.1852,  .0835, -.0235,  .6573, -.2963,  .0835,-1.4580,  &
     .6573, -.1852,  .4108, -.1852,  .0522,-1.4580,  .6573, -.1852/
 DATA ex8g32/ 3.2341,-1.4580,  .4108,  &
     .4108, -.1852,  .0522,-1.4580,  .6573, -.1852, 3.2341,-1.4580,  &
     .4108, -.1852,  .0835, -.0235,  .6573, -.2963,  .0835,-1.4580,  &
     .6573, -.1852,  .0522, -.0235,  .0066, -.1852,  .0835, -.0235,  &
     .4108, -.1852,  .0522,  &
     3.2341,-1.4580,  .4108,-1.4580,  .6573, -.1852,  .4108, -.1852,  &
     .0522,-1.4580,  .6573, -.1852,  .6573, -.2963,  .0835, -.1852,  &
     .0835, -.0235,  .4108, -.1852,  .0522, -.1852,  .0835, -.0235,  &
     .0522, -.0235,  .0066,  &
     .4108, -.1852,  .0522, -.1852,  .0835, -.0235,  .0522, -.0235,  &
     .0066,-1.4580,  .6573, -.1852,  .6573, -.2963,  .0835, -.1852,  &
     .0835, -.0235, 3.2341,-1.4580,  .4108,-1.4580,  .6573, -.1852,  &
     .4108, -.1852,  .0522,  &
     -.0000,  .0000,  .0000,  .0000,  .0000,  .0000,  .0000, -.0000,  &
     -.0000, 0.0000,  .0000,  .0000,  .0000, 1.0000,  .0000, -.0000,  &
     -.0000, -.0000,  .0000,  .0000, -.0000, -.0000,  .0000,  .0000,  &
     -.0000,  .0000,  .0000/
 DATA ex8g41/  &
     -.0015,  .0052, -.0106,  .0198,  .0052, -.0183,  .0371, -.0697,  &
     -.0106,  .0371, -.0754,  .1415,  .0198, -.0697,  .1415, -.2656,  &
     .0052, -.0183,  .0371, -.0697, -.0183,  .0644, -.1307,  .2452,  &
     .0371, -.1307,  .2653, -.4978, -.0697,  .2452, -.4978,  .9342,  &
     -.0106,  .0371, -.0754,  .1415,  .0371, -.1307,  .2653, -.4978,  &
     -.0754,  .2653, -.5386, 1.0107,  .1415, -.4978, 1.0107,-1.8966,  &
     .0198, -.0697,  .1415, -.2656, -.0697,  .2452, -.4978,  .9342,  &
     .1415, -.4978, 1.0107,-1.8966, -.2656,  .9342,-1.8966, 3.5591,  &
     .0198, -.0697,  .1415, -.2656, -.0697,  .2452, -.4978,  .9342,  &
     .1415, -.4978, 1.0107,-1.8966, -.2656,  .9342,-1.8966, 3.5591,  &
     -.0106,  .0371, -.0754,  .1415,  .0371, -.1307,  .2653, -.4978,  &
     -.0754,  .2653, -.5386, 1.0107,  .1415, -.4978, 1.0107,-1.8966,  &
     .0052, -.0183,  .0371, -.0697, -.0183,  .0644, -.1307,  .2452,  &
     .0371, -.1307,  .2653, -.4978, -.0697,  .2452, -.4978,  .9342,  &
     -.0015,  .0052, -.0106,  .0198,  .0052, -.0183,  .0371, -.0697,  &
     -.0106,  .0371, -.0754,  .1415,  .0198, -.0697,  .1415, -.2656,  &
     -.2656,  .9342,-1.8966, 3.5591,  .1415, -.4978, 1.0107,-1.8966,  &
     -.0697,  .2452, -.4978,  .9342,  .0198, -.0697,  .1415, -.2656,  &
     .1415, -.4978, 1.0107,-1.8966, -.0754,  .2653, -.5386, 1.0107/
 DATA ex8g42/  &
     .0371, -.1307,  .2653, -.4978, -.0106,  .0371, -.0754,  .1415,  &
     -.0697,  .2452, -.4978,  .9342,  .0371, -.1307,  .2653, -.4978,  &
     -.0183,  .0644, -.1307,  .2452,  .0052, -.0183,  .0371, -.0697,  &
     .0198, -.0697,  .1415, -.2656, -.0106,  .0371, -.0754,  .1415,  &
     .0052, -.0183,  .0371, -.0697, -.0015,  .0052, -.0106,  .0198,  &
     .0198, -.0697,  .1415, -.2656, -.0106,  .0371, -.0754,  .1415,  &
     .0052, -.0183,  .0371, -.0697, -.0015,  .0052, -.0106,  .0198,  &
     -.0697,  .2452, -.4978,  .9342,  .0371, -.1307,  .2653, -.4978,  &
     -.0183,  .0644, -.1307,  .2452,  .0052, -.0183,  .0371, -.0697,  &
     .1415, -.4978, 1.0107,-1.8966, -.0754,  .2653, -.5386, 1.0107,  &
     .0371, -.1307,  .2653, -.4978, -.0106,  .0371, -.0754,  .1415,  &
     -.2656,  .9342,-1.8966, 3.5591,  .1415, -.4978, 1.0107,-1.8966,  &
     -.0697,  .2452, -.4978,  .9342,  .0198, -.0697,  .1415, -.2656,  &
     .0198, -.0106,  .0052, -.0015, -.0697,  .0371, -.0183,  .0052,  &
     .1415, -.0754,  .0371, -.0106, -.2656,  .1415, -.0697,  .0198,  &
     -.0697,  .0371, -.0183,  .0052,  .2452, -.1307,  .0644, -.0183,  &
     -.4978,  .2653, -.1307,  .0371,  .9342, -.4978,  .2452, -.0697,  &
     .1415, -.0754,  .0371, -.0106, -.4978,  .2653, -.1307,  .0371,  &
     1.0107, -.5386,  .2653, -.0754,-1.8966, 1.0107, -.4978,  .1415/
 DATA ex8g43/  &
     -.2656,  .1415, -.0697,  .0198,  .9342, -.4978,  .2452, -.0697,  &
     -1.8966, 1.0107, -.4978,  .1415, 3.5591,-1.8966,  .9342, -.2656,  &
     -.2656,  .1415, -.0697,  .0198,  .9342, -.4978,  .2452, -.0697,  &
     -1.8966, 1.0107, -.4978,  .1415, 3.5591,-1.8966,  .9342, -.2656,  &
     .1415, -.0754,  .0371, -.0106, -.4978,  .2653, -.1307,  .0371,  &
     1.0107, -.5386,  .2653, -.0754,-1.8966, 1.0107, -.4978,  .1415,  &
     -.0697,  .0371, -.0183,  .0052,  .2452, -.1307,  .0644, -.0183,  &
     -.4978,  .2653, -.1307,  .0371,  .9342, -.4978,  .2452, -.0697,  &
     .0198, -.0106,  .0052, -.0015, -.0697,  .0371, -.0183,  .0052,  &
     .1415, -.0754,  .0371, -.0106, -.2656,  .1415, -.0697,  .0198,  &
     3.5591,-1.8966,  .9342, -.2656,-1.8966, 1.0107, -.4978,  .1415,  &
     .9342, -.4978,  .2452, -.0697, -.2656,  .1415, -.0697,  .0198,  &
     -1.8966, 1.0107, -.4978,  .1415, 1.0107, -.5386,  .2653, -.0754,  &
     -.4978,  .2653, -.1307,  .0371,  .1415, -.0754,  .0371, -.0106,  &
     .9342, -.4978,  .2452, -.0697, -.4978,  .2653, -.1307,  .0371,  &
     .2452, -.1307,  .0644, -.0183, -.0697,  .0371, -.0183,  .0052,  &
     -.2656,  .1415, -.0697,  .0198,  .1415, -.0754,  .0371, -.0106,  &
     -.0697,  .0371, -.0183,  .0052,  .0198, -.0106,  .0052, -.0015,  &
     -.2656,  .1415, -.0697,  .0198,  .1415, -.0754,  .0371, -.0106/
 DATA ex8g44/  &
     -.0697,  .0371, -.0183,  .0052,  .0198, -.0106,  .0052, -.0015,  &
     .9342, -.4978,  .2452, -.0697, -.4978,  .2653, -.1307,  .0371,  &
     .2452, -.1307,  .0644, -.0183, -.0697,  .0371, -.0183,  .0052,  &
     -1.8966, 1.0107, -.4978,  .1415, 1.0107, -.5386,  .2653, -.0754,  &
     -.4978,  .2653, -.1307,  .0371,  .1415, -.0754,  .0371, -.0106,  &
     3.5591,-1.8966,  .9342, -.2656,-1.8966, 1.0107, -.4978,  .1415,  &
     .9342, -.4978,  .2452, -.0697, -.2656,  .1415, -.0697,  .0198,  &
     -.0008,  .0050,  .0050, -.0008,  .0050, -.0324, -.0324,  .0050,  &
     .0050, -.0324, -.0324,  .0050, -.0008,  .0050,  .0050, -.0008,  &
     .0050, -.0324, -.0324,  .0050, -.0324,  .2078,  .2078, -.0324,  &
     -.0324,  .2078,  .2078, -.0324,  .0050, -.0324, -.0324,  .0050,  &
     .0050, -.0324, -.0324,  .0050, -.0324,  .2078,  .2078, -.0324,  &
     -.0324,  .2078,  .2078, -.0324,  .0050, -.0324, -.0324,  .0050,  &
     -.0008,  .0050,  .0050, -.0008,  .0050, -.0324, -.0324,  .0050,  &
     .0050, -.0324, -.0324,  .0050, -.0008,  .0050,  .0050, -.0008/
 DATA ex2021/  &
     -.0490,  .1830,  .1830, -.6830,  .1830, -.6830, -.6830, 2.5490,  &
     .0670, -.2500, -.2500,  .9330,  .0670, -.2500, -.2500,  .9330,  &
     .1830, -.6830, -.6830, 2.5490, -.0490,  .1830,  .1830, -.6830,  &
     -.2500,  .9330, -.2500,  .9330,  .0670, -.2500,  .0670, -.2500,  &
     -.6830, 2.5490,  .1830, -.6830,  .1830, -.6830, -.0490,  .1830,  &
     -.2500,  .9330,  .0670, -.2500, -.2500,  .9330,  .0670, -.2500,  &
     .1830, -.6830, -.0490,  .1830, -.6830, 2.5490,  .1830, -.6830,  &
     .0670, -.2500,  .0670, -.2500, -.2500,  .9330, -.2500,  .9330,  &
     .0670,  .0670, -.2500, -.2500, -.2500, -.2500,  .9330,  .9330,  &
     -.2500, -.2500,  .9330,  .9330,  .0670,  .0670, -.2500, -.2500,  &
     .9330,  .9330, -.2500, -.2500, -.2500, -.2500,  .0670,  .0670,  &
     -.2500, -.2500,  .0670,  .0670,  .9330,  .9330, -.2500, -.2500,  &
     .1830, -.0490, -.6830,  .1830, -.6830,  .1830, 2.5490, -.6830,  &
     -.2500,  .0670,  .9330, -.2500, -.2500,  .0670,  .9330, -.2500,  &
     -.6830,  .1830, 2.5490, -.6830,  .1830, -.0490, -.6830,  .1830,  &
     .9330, -.2500,  .9330, -.2500, -.2500,  .0670, -.2500,  .0670,  &
     2.5490, -.6830, -.6830,  .1830, -.6830,  .1830,  .1830, -.0490,  &
     .9330, -.2500, -.2500,  .0670,  .9330, -.2500, -.2500,  .0670,  &
     -.6830,  .1830,  .1830, -.0490, 2.5490, -.6830, -.6830,  .1830/
 DATA ex2022/  &
     -.2500,  .0670, -.2500,  .0670,  .9330, -.2500,  .9330, -.2500,  &
     .1250,  .1250,  .1250,  .1250,  .1250,  .1250,  .1250,  .1250/
 DATA ex2031/  &
     .0066, -.0235,  .0522, -.0235,  .0835, -.1852,  .0522, -.1852,  &
     .4108, -.0235,  .0835, -.1852,  .0835, -.2963,  .6573, -.1852,  &
     .6573,-1.4580,  .0522, -.1852,  .4108, -.1852,  .6573,-1.4580,  &
     .4108,-1.4580, 3.2341,  &
     -.0000,  .0000, -.0000,  .0000, -.0000,  .0000, -.0000,  .0000,  &
     -.0000,  .0353, -.1252,  .2778, -.1252,  .4444, -.9859,  .2778,  &
     -.9859, 2.1869,  .0000,  .0000, -.0000, -.0000,  .0000,  .0000,  &
     -.0000,  .0000,  .0000,  &
     .0522, -.1852,  .4108, -.1852,  .6573,-1.4580,  .4108,-1.4580,  &
     3.2341, -.0235,  .0835, -.1852,  .0835, -.2963,  .6573, -.1852,  &
     .6573,-1.4580,  .0066, -.0235,  .0522, -.0235,  .0835, -.1852,  &
     .0522, -.1852,  .4108,  &
     -.0000,  .0000,  .0000,  .2778, -.9859, 2.1869,  .0000,  .0000,  &
     -.0000,  .0000,  .0000,  .0000, -.1252,  .4444, -.9859, -.0000,  &
     .0000, -.0000, -.0000, -.0000,  .0000,  .0353, -.1252,  .2778,  &
     -.0000,  .0000, -.0000,  &
     .4108,-1.4580, 3.2341, -.1852,  .6573,-1.4580,  .0522, -.1852,  &
     .4108, -.1852,  .6573,-1.4580,  .0835, -.2963,  .6573, -.0235,  &
     .0835, -.1852,  .0522, -.1852,  .4108, -.0235,  .0835, -.1852/
 DATA ex2032/ .0066, -.0235,  .0522,  &
     -.0000,  .0000, -.0000,  .0000, -.0000,  .0000,  .0000,  .0000,  &
     -.0000,  .2778, -.9859, 2.1869, -.1252,  .4444, -.9859,  .0353,  &
     -.1252,  .2778,  .0000,  .0000,  .0000, -.0000,  .0000,  .0000,  &
     -.0000,  .0000, -.0000,  &
     .0522, -.1852,  .4108, -.0235,  .0835, -.1852,  .0066, -.0235,  &
     .0522, -.1852,  .6573,-1.4580,  .0835, -.2963,  .6573, -.0235,  &
     .0835, -.1852,  .4108,-1.4580, 3.2341, -.1852,  .6573,-1.4580,  &
     .0522, -.1852,  .4108,  &
     -.0000,  .0000, -.0000,  .0353, -.1252,  .2778,  .0000,  .0000,  &
     -.0000,  .0000,  .0000,  .0000, -.1252,  .4444, -.9859, -.0000,  &
     .0000, -.0000, -.0000,  .0000,  .0000,  .2778, -.9859, 2.1869,  &
     -.0000, -.0000, -.0000,  &
     -.0000,  .0353,  .0000,  .0000, -.1252,  .0000, -.0000,  .2778,  &
     -.0000,  .0000, -.1252,  .0000,  .0000,  .4444,  .0000,  .0000,  &
     -.9859, -.0000,  .0000,  .2778, -.0000, -.0000, -.9859, -.0000,  &
     .0000, 2.1869,  .0000,  &
     -.0000,  .2778, -.0000,  .0000, -.9859,  .0000, -.0000, 2.1869,  &
     .0000,  .0000, -.1252,  .0000,  .0000,  .4444,  .0000,  .0000/
 DATA ex2033/  &
     -.9859, -.0000, -.0000,  .0353,  .0000, -.0000, -.1252, -.0000,  &
     -.0000,  .2778, -.0000,  &
     -.0000, 2.1869, -.0000,  .0000, -.9859,  .0000, -.0000,  .2778,  &
     -.0000,  .0000, -.9859,  .0000,  .0000,  .4444,  .0000, -.0000,  &
     -.1252, -.0000, -.0000,  .2778,  .0000, -.0000, -.1252, -.0000,  &
     -.0000,  .0353,  .0000,  &
     -.0000,  .2778, -.0000,  .0000, -.1252,  .0000, -.0000,  .0353,  &
     .0000,  .0000, -.9859,  .0000,  .0000,  .4444,  .0000, -.0000,  &
     -.1252, -.0000,  .0000, 2.1869,  .0000, -.0000, -.9859, -.0000,  &
     -.0000,  .2778,  .0000,  &
     .0522, -.0235,  .0066, -.1852,  .0835, -.0235,  .4108, -.1852,  &
     .0522, -.1852,  .0835, -.0235,  .6573, -.2963,  .0835,-1.4580,  &
     .6573, -.1852,  .4108, -.1852,  .0522,-1.4580,  .6573, -.1852,  &
     3.2341,-1.4580,  .4108,  &
     -.0000,  .0000, -.0000,  .0000, -.0000,  .0000, -.0000,  .0000,  &
     -.0000,  .2778, -.1252,  .0353, -.9859,  .4444, -.1252, 2.1869,  &
     -.9859,  .2778,  .0000,  .0000,  .0000, -.0000,  .0000,  .0000,  &
     -.0000,  .0000,  .0000,  &
     .4108, -.1852,  .0522,-1.4580,  .6573, -.1852, 3.2341,-1.4580/
 DATA ex2034/  &
     .4108, -.1852,  .0835, -.0235,  .6573, -.2963,  .0835,-1.4580,  &
     .6573, -.1852,  .0522, -.0235,  .0066, -.1852,  .0835, -.0235,  &
     .4108, -.1852,  .0522,  &
     -.0000,  .0000, -.0000, 2.1869, -.9859,  .2778, -.0000,  .0000,  &
     -.0000,  .0000,  .0000,  .0000, -.9859,  .4444, -.1252, -.0000,  &
     .0000, -.0000, -.0000, -.0000, -.0000,  .2778, -.1252,  .0353,  &
     -.0000,  .0000, -.0000,  &
     3.2341,-1.4580,  .4108,-1.4580,  .6573, -.1852,  .4108, -.1852,  &
     .0522,-1.4580,  .6573, -.1852,  .6573, -.2963,  .0835, -.1852,  &
     .0835, -.0235,  .4108, -.1852,  .0522, -.1852,  .0835, -.0235,  &
     .0522, -.0235,  .0066,  &
     -.0000,  .0000, -.0000,  .0000, -.0000,  .0000, -.0000,  .0000,  &
     -.0000, 2.1869, -.9859,  .2778, -.9859,  .4444, -.1252,  .2778,  &
     -.1252,  .0353,  .0000,  .0000,  .0000, -.0000,  .0000,  .0000,  &
     -.0000,  .0000, -.0000,  &
     .4108, -.1852,  .0522, -.1852,  .0835, -.0235,  .0522, -.0235,  &
     .0066,-1.4580,  .6573, -.1852,  .6573, -.2963,  .0835, -.1852,  &
     .0835, -.0235, 3.2341,-1.4580,  .4108,-1.4580,  .6573, -.1852,  &
     .4108, -.1852,  .0522/
 DATA ex2035/  &
     -.0000,  .0000, -.0000,  .2778, -.1252,  .0353, -.0000,  .0000,  &
     .0000,  .0000,  .0000,  .0000, -.9859,  .4444, -.1252, -.0000,  &
     .0000, -.0000,  .0000,  .0000,  .0000, 2.1869, -.9859,  .2778,  &
     -.0000, -.0000, -.0000,  &
     -.0000,  .0000,  .0000,  .0000,  .0000,  .0000,  .0000, -.0000,  &
     -.0000, 0.0000,  .0000,  .0000,  .0000, 1.0000,  .0000, -.0000,  &
     -.0000, -.0000,  .0000,  .0000, -.0000, -.0000,  .0000,  .0000,  &
     -.0000,  .0000,  .0000/
 DATA ex2041/  &
     -.0015,  .0052, -.0106,  .0198,  .0052, -.0183,  .0371, -.0697,  &
     -.0106,  .0371, -.0754,  .1415,  .0198, -.0697,  .1415, -.2656,  &
     .0052, -.0183,  .0371, -.0697, -.0183,  .0644, -.1307,  .2452,  &
     .0371, -.1307,  .2653, -.4978, -.0697,  .2452, -.4978,  .9342,  &
     -.0106,  .0371, -.0754,  .1415,  .0371, -.1307,  .2653, -.4978,  &
     -.0754,  .2653, -.5386, 1.0107,  .1415, -.4978, 1.0107,-1.8966,  &
     .0198, -.0697,  .1415, -.2656, -.0697,  .2452, -.4978,  .9342,  &
     .1415, -.4978, 1.0107,-1.8966, -.2656,  .9342,-1.8966, 3.5591,  &
     -.0012,  .0042, -.0086,  .0161,  .0042, -.0148,  .0301, -.0565,  &
     -.0086,  .0301, -.0611,  .1147,  .0161, -.0565,  .1147, -.2152,  &
     .0077, -.0270,  .0549, -.1030, -.0270,  .0951, -.1931,  .3624,  &
     .0549, -.1931,  .3921, -.7358, -.1030,  .3624, -.7358, 1.3808,  &
     .0077, -.0270,  .0549, -.1030, -.0270,  .0951, -.1931,  .3624,  &
     .0549, -.1931,  .3921, -.7358, -.1030,  .3624, -.7358, 1.3808,  &
     -.0012,  .0042, -.0086,  .0161,  .0042, -.0148,  .0301, -.0565,  &
     -.0086,  .0301, -.0611,  .1147,  .0161, -.0565,  .1147, -.2152,  &
     .0198, -.0697,  .1415, -.2656, -.0697,  .2452, -.4978,  .9342,  &
     .1415, -.4978, 1.0107,-1.8966, -.2656,  .9342,-1.8966, 3.5591,  &
     -.0106,  .0371, -.0754,  .1415,  .0371, -.1307,  .2653, -.4978/
 DATA ex2042/  &
     -.0754,  .2653, -.5386, 1.0107,  .1415, -.4978, 1.0107,-1.8966,  &
     .0052, -.0183,  .0371, -.0697, -.0183,  .0644, -.1307,  .2452,  &
     .0371, -.1307,  .2653, -.4978, -.0697,  .2452, -.4978,  .9342,  &
     -.0015,  .0052, -.0106,  .0198,  .0052, -.0183,  .0371, -.0697,  &
     -.0106,  .0371, -.0754,  .1415,  .0198, -.0697,  .1415, -.2656,  &
     .0161, -.0565,  .1147, -.2152, -.1030,  .3624, -.7358, 1.3808,  &
     -.1030,  .3624, -.7358, 1.3808,  .0161, -.0565,  .1147, -.2152,  &
     -.0086,  .0301, -.0611,  .1147,  .0549, -.1931,  .3921, -.7358,  &
     .0549, -.1931,  .3921, -.7358, -.0086,  .0301, -.0611,  .1147,  &
     .0042, -.0148,  .0301, -.0565, -.0270,  .0951, -.1931,  .3624,  &
     -.0270,  .0951, -.1931,  .3624,  .0042, -.0148,  .0301, -.0565,  &
     -.0012,  .0042, -.0086,  .0161,  .0077, -.0270,  .0549, -.1030,  &
     .0077, -.0270,  .0549, -.1030, -.0012,  .0042, -.0086,  .0161,  &
     -.2656,  .9342,-1.8966, 3.5591,  .1415, -.4978, 1.0107,-1.8966,  &
     -.0697,  .2452, -.4978,  .9342,  .0198, -.0697,  .1415, -.2656,  &
     .1415, -.4978, 1.0107,-1.8966, -.0754,  .2653, -.5386, 1.0107,  &
     .0371, -.1307,  .2653, -.4978, -.0106,  .0371, -.0754,  .1415,  &
     -.0697,  .2452, -.4978,  .9342,  .0371, -.1307,  .2653, -.4978,  &
     -.0183,  .0644, -.1307,  .2452,  .0052, -.0183,  .0371, -.0697/
 DATA ex2043/  &
     .0198, -.0697,  .1415, -.2656, -.0106,  .0371, -.0754,  .1415,  &
     .0052, -.0183,  .0371, -.0697, -.0015,  .0052, -.0106,  .0198,  &
     .0161, -.0565,  .1147, -.2152, -.0086,  .0301, -.0611,  .1147,  &
     .0042, -.0148,  .0301, -.0565, -.0012,  .0042, -.0086,  .0161,  &
     -.1030,  .3624, -.7358, 1.3808,  .0549, -.1931,  .3921, -.7358,  &
     -.0270,  .0951, -.1931,  .3624,  .0077, -.0270,  .0549, -.1030,  &
     -.1030,  .3624, -.7358, 1.3808,  .0549, -.1931,  .3921, -.7358,  &
     -.0270,  .0951, -.1931,  .3624,  .0077, -.0270,  .0549, -.1030,  &
     .0161, -.0565,  .1147, -.2152, -.0086,  .0301, -.0611,  .1147,  &
     .0042, -.0148,  .0301, -.0565, -.0012,  .0042, -.0086,  .0161,  &
     .0198, -.0697,  .1415, -.2656, -.0106,  .0371, -.0754,  .1415,  &
     .0052, -.0183,  .0371, -.0697, -.0015,  .0052, -.0106,  .0198,  &
     -.0697,  .2452, -.4978,  .9342,  .0371, -.1307,  .2653, -.4978,  &
     -.0183,  .0644, -.1307,  .2452,  .0052, -.0183,  .0371, -.0697,  &
     .1415, -.4978, 1.0107,-1.8966, -.0754,  .2653, -.5386, 1.0107,  &
     .0371, -.1307,  .2653, -.4978, -.0106,  .0371, -.0754,  .1415,  &
     -.2656,  .9342,-1.8966, 3.5591,  .1415, -.4978, 1.0107,-1.8966,  &
     -.0697,  .2452, -.4978,  .9342,  .0198, -.0697,  .1415, -.2656,  &
     -.0012,  .0042, -.0086,  .0161,  .0077, -.0270,  .0549, -.1030/
 DATA ex2044/  &
     .0077, -.0270,  .0549, -.1030, -.0012,  .0042, -.0086,  .0161,  &
     .0042, -.0148,  .0301, -.0565, -.0270,  .0951, -.1931,  .3624,  &
     -.0270,  .0951, -.1931,  .3624,  .0042, -.0148,  .0301, -.0565,  &
     -.0086,  .0301, -.0611,  .1147,  .0549, -.1931,  .3921, -.7358,  &
     .0549, -.1931,  .3921, -.7358, -.0086,  .0301, -.0611,  .1147,  &
     .0161, -.0565,  .1147, -.2152, -.1030,  .3624, -.7358, 1.3808,  &
     -.1030,  .3624, -.7358, 1.3808,  .0161, -.0565,  .1147, -.2152,  &
     -.0012,  .0077,  .0077, -.0012,  .0042, -.0270, -.0270,  .0042,  &
     -.0086,  .0549,  .0549, -.0086,  .0161, -.1030, -.1030,  .0161,  &
     .0042, -.0270, -.0270,  .0042, -.0148,  .0951,  .0951, -.0148,  &
     .0301, -.1931, -.1931,  .0301, -.0565,  .3624,  .3624, -.0565,  &
     -.0086,  .0549,  .0549, -.0086,  .0301, -.1931, -.1931,  .0301,  &
     -.0611,  .3921,  .3921, -.0611,  .1147, -.7358, -.7358,  .1147,  &
     .0161, -.1030, -.1030,  .0161, -.0565,  .3624,  .3624, -.0565,  &
     .1147, -.7358, -.7358,  .1147, -.2152, 1.3808, 1.3808, -.2152,  &
     .0161, -.1030, -.1030,  .0161, -.0565,  .3624,  .3624, -.0565,  &
     .1147, -.7358, -.7358,  .1147, -.2152, 1.3808, 1.3808, -.2152,  &
     -.0086,  .0549,  .0549, -.0086,  .0301, -.1931, -.1931,  .0301,  &
     -.0611,  .3921,  .3921, -.0611,  .1147, -.7358, -.7358,  .1147/
 DATA ex2045/  &
     .0042, -.0270, -.0270,  .0042, -.0148,  .0951,  .0951, -.0148,  &
     .0301, -.1931, -.1931,  .0301, -.0565,  .3624,  .3624, -.0565,  &
     -.0012,  .0077,  .0077, -.0012,  .0042, -.0270, -.0270,  .0042,  &
     -.0086,  .0549,  .0549, -.0086,  .0161, -.1030, -.1030,  .0161,  &
     -.2152, 1.3808, 1.3808, -.2152,  .1147, -.7358, -.7358,  .1147,  &
     -.0565,  .3624,  .3624, -.0565,  .0161, -.1030, -.1030,  .0161,  &
     .1147, -.7358, -.7358,  .1147, -.0611,  .3921,  .3921, -.0611,  &
     .0301, -.1931, -.1931,  .0301, -.0086,  .0549,  .0549, -.0086,  &
     -.0565,  .3624,  .3624, -.0565,  .0301, -.1931, -.1931,  .0301,  &
     -.0148,  .0951,  .0951, -.0148,  .0042, -.0270, -.0270,  .0042,  &
     .0161, -.1030, -.1030,  .0161, -.0086,  .0549,  .0549, -.0086,  &
     .0042, -.0270, -.0270,  .0042, -.0012,  .0077,  .0077, -.0012,  &
     .0161, -.1030, -.1030,  .0161, -.0086,  .0549,  .0549, -.0086,  &
     .0042, -.0270, -.0270,  .0042, -.0012,  .0077,  .0077, -.0012,  &
     -.0565,  .3624,  .3624, -.0565,  .0301, -.1931, -.1931,  .0301,  &
     -.0148,  .0951,  .0951, -.0148,  .0042, -.0270, -.0270,  .0042,  &
     .1147, -.7358, -.7358,  .1147, -.0611,  .3921,  .3921, -.0611,  &
     .0301, -.1931, -.1931,  .0301, -.0086,  .0549,  .0549, -.0086,  &
     -.2152, 1.3808, 1.3808, -.2152,  .1147, -.7358, -.7358,  .1147/
 DATA ex2046/  &
     -.0565,  .3624,  .3624, -.0565,  .0161, -.1030, -.1030,  .0161,  &
     .0198, -.0106,  .0052, -.0015, -.0697,  .0371, -.0183,  .0052,  &
     .1415, -.0754,  .0371, -.0106, -.2656,  .1415, -.0697,  .0198,  &
     -.0697,  .0371, -.0183,  .0052,  .2452, -.1307,  .0644, -.0183,  &
     -.4978,  .2653, -.1307,  .0371,  .9342, -.4978,  .2452, -.0697,  &
     .1415, -.0754,  .0371, -.0106, -.4978,  .2653, -.1307,  .0371,  &
     1.0107, -.5386,  .2653, -.0754,-1.8966, 1.0107, -.4978,  .1415,  &
     -.2656,  .1415, -.0697,  .0198,  .9342, -.4978,  .2452, -.0697,  &
     -1.8966, 1.0107, -.4978,  .1415, 3.5591,-1.8966,  .9342, -.2656,  &
     .0161, -.0086,  .0042, -.0012, -.0565,  .0301, -.0148,  .0042,  &
     .1147, -.0611,  .0301, -.0086, -.2152,  .1147, -.0565,  .0161,  &
     -.1030,  .0549, -.0270,  .0077,  .3624, -.1931,  .0951, -.0270,  &
     -.7358,  .3921, -.1931,  .0549, 1.3808, -.7358,  .3624, -.1030,  &
     -.1030,  .0549, -.0270,  .0077,  .3624, -.1931,  .0951, -.0270,  &
     -.7358,  .3921, -.1931,  .0549, 1.3808, -.7358,  .3624, -.1030,  &
     .0161, -.0086,  .0042, -.0012, -.0565,  .0301, -.0148,  .0042,  &
     .1147, -.0611,  .0301, -.0086, -.2152,  .1147, -.0565,  .0161,  &
     -.2656,  .1415, -.0697,  .0198,  .9342, -.4978,  .2452, -.0697,  &
     -1.8966, 1.0107, -.4978,  .1415, 3.5591,-1.8966,  .9342, -.2656/
 DATA ex2047/  &
     .1415, -.0754,  .0371, -.0106, -.4978,  .2653, -.1307,  .0371,  &
     1.0107, -.5386,  .2653, -.0754,-1.8966, 1.0107, -.4978,  .1415,  &
     -.0697,  .0371, -.0183,  .0052,  .2452, -.1307,  .0644, -.0183,  &
     -.4978,  .2653, -.1307,  .0371,  .9342, -.4978,  .2452, -.0697,  &
     .0198, -.0106,  .0052, -.0015, -.0697,  .0371, -.0183,  .0052,  &
     .1415, -.0754,  .0371, -.0106, -.2656,  .1415, -.0697,  .0198,  &
     -.2152,  .1147, -.0565,  .0161, 1.3808, -.7358,  .3624, -.1030,  &
     1.3808, -.7358,  .3624, -.1030, -.2152,  .1147, -.0565,  .0161,  &
     .1147, -.0611,  .0301, -.0086, -.7358,  .3921, -.1931,  .0549,  &
     -.7358,  .3921, -.1931,  .0549,  .1147, -.0611,  .0301, -.0086,  &
     -.0565,  .0301, -.0148,  .0042,  .3624, -.1931,  .0951, -.0270,  &
     .3624, -.1931,  .0951, -.0270, -.0565,  .0301, -.0148,  .0042,  &
     .0161, -.0086,  .0042, -.0012, -.1030,  .0549, -.0270,  .0077,  &
     -.1030,  .0549, -.0270,  .0077,  .0161, -.0086,  .0042, -.0012,  &
     3.5591,-1.8966,  .9342, -.2656,-1.8966, 1.0107, -.4978,  .1415,  &
     .9342, -.4978,  .2452, -.0697, -.2656,  .1415, -.0697,  .0198,  &
     -1.8966, 1.0107, -.4978,  .1415, 1.0107, -.5386,  .2653, -.0754,  &
     -.4978,  .2653, -.1307,  .0371,  .1415, -.0754,  .0371, -.0106,  &
     .9342, -.4978,  .2452, -.0697, -.4978,  .2653, -.1307,  .0371/
 DATA ex2048/  &
     .2452, -.1307,  .0644, -.0183, -.0697,  .0371, -.0183,  .0052,  &
     -.2656,  .1415, -.0697,  .0198,  .1415, -.0754,  .0371, -.0106,  &
     -.0697,  .0371, -.0183,  .0052,  .0198, -.0106,  .0052, -.0015,  &
     -.2152,  .1147, -.0565,  .0161,  .1147, -.0611,  .0301, -.0086,  &
     -.0565,  .0301, -.0148,  .0042,  .0161, -.0086,  .0042, -.0012,  &
     1.3808, -.7358,  .3624, -.1030, -.7358,  .3921, -.1931,  .0549,  &
     .3624, -.1931,  .0951, -.0270, -.1030,  .0549, -.0270,  .0077,  &
     1.3808, -.7358,  .3624, -.1030, -.7358,  .3921, -.1931,  .0549,  &
     .3624, -.1931,  .0951, -.0270, -.1030,  .0549, -.0270,  .0077,  &
     -.2152,  .1147, -.0565,  .0161,  .1147, -.0611,  .0301, -.0086,  &
     -.0565,  .0301, -.0148,  .0042,  .0161, -.0086,  .0042, -.0012,  &
     -.2656,  .1415, -.0697,  .0198,  .1415, -.0754,  .0371, -.0106,  &
     -.0697,  .0371, -.0183,  .0052,  .0198, -.0106,  .0052, -.0015,  &
     .9342, -.4978,  .2452, -.0697, -.4978,  .2653, -.1307,  .0371,  &
     .2452, -.1307,  .0644, -.0183, -.0697,  .0371, -.0183,  .0052,  &
     -1.8966, 1.0107, -.4978,  .1415, 1.0107, -.5386,  .2653, -.0754,  &
     -.4978,  .2653, -.1307,  .0371,  .1415, -.0754,  .0371, -.0106,  &
     3.5591,-1.8966,  .9342, -.2656,-1.8966, 1.0107, -.4978,  .1415,  &
     .9342, -.4978,  .2452, -.0697, -.2656,  .1415, -.0697,  .0198/
 DATA ex2049/  &
     .0161, -.0086,  .0042, -.0012, -.1030,  .0549, -.0270,  .0077,  &
     -.1030,  .0549, -.0270,  .0077,  .0161, -.0086,  .0042, -.0012,  &
     -.0565,  .0301, -.0148,  .0042,  .3624, -.1931,  .0951, -.0270,  &
     .3624, -.1931,  .0951, -.0270, -.0565,  .0301, -.0148,  .0042,  &
     .1147, -.0611,  .0301, -.0086, -.7358,  .3921, -.1931,  .0549,  &
     -.7358,  .3921, -.1931,  .0549,  .1147, -.0611,  .0301, -.0086,  &
     -.2152,  .1147, -.0565,  .0161, 1.3808, -.7358,  .3624, -.1030,  &
     1.3808, -.7358,  .3624, -.1030, -.2152,  .1147, -.0565,  .0161,  &
     -.0008,  .0050,  .0050, -.0008,  .0050, -.0324, -.0324,  .0050,  &
     .0050, -.0324, -.0324,  .0050, -.0008,  .0050,  .0050, -.0008,  &
     .0050, -.0324, -.0324,  .0050, -.0324,  .2078,  .2078, -.0324,  &
     -.0324,  .2078,  .2078, -.0324,  .0050, -.0324, -.0324,  .0050,  &
     .0050, -.0324, -.0324,  .0050, -.0324,  .2078,  .2078, -.0324,  &
     -.0324,  .2078,  .2078, -.0324,  .0050, -.0324, -.0324,  .0050,  &
     -.0008,  .0050,  .0050, -.0008,  .0050, -.0324, -.0324,  .0050,  &
     .0050, -.0324, -.0324,  .0050, -.0008,  .0050,  .0050, -.0008/
 
 DATA        dtor        /0.0174532925E0/
 DATA        nequ        /200/
 DATA        oldeid      / 0 /
 DATA        lld,lsub,frlast / 2*-1,2*-1.0E30 /
 DATA        typ         / 4HIHEX,1H1,1H2,1H3 /
 
!*****
!     IF THIS IS THE FIRST STRESS POINT IN AN ELEMENT, INITIALIZE
!     COUNTER AND GET EXTERNAL GRID POINT NUMBERS
!*****
 IF (istore == 1) GO TO 2633
 IF (oldeid == iesta(1)) GO TO 200
 strspt=0
 ipts=(TYPE-1)/2
 ngp =12*TYPE-4
 ngp1=ngp+1
 IF (TYPE == 3) ngp1=21
 nip=iesta(20*ngp+9)
 
!     IF EQEXIN NOT YET READ IN, READ IT.
 
 IF (isopl /= eqexin  .AND. oldeid /= 0) GO TO 10
 isopl=-1
 itrl(1)=eqexin
 CALL rdtrl (itrl)
 leqx =itrl(2)*2
 mxleq=(nequ/2)*2
 neqx =(leqx-1)/mxleq+1
 l=leqx
 IF (neqx > 1) l=mxleq
 iend = 0
 CALL READ (*140,*140,eqexin,equ,l,0,i)
 DO  i=2,l,2
   equ(i)=IABS(equ(i))
 END DO
 CALL sort (0,0,2,2,equ,l)
 l=l/2
 
!     CONVERT SIL NUMBERS TO EXTERNAL GRID POINT NUMBERS
 
 10 oldeid = iesta(1)
 DO  i = 1,ngp
   extrnl(i)=-iesta(i+1)
 END DO
 DO  j=1,neqx
   16 DO  i=1,ngp
     IF (extrnl(i) > 0) CYCLE
     sil=iesta(i+1)*10+1
     
!     BINARY SEARCH FOR MATCH ON SIL NUMBER
     
     klo=1
     khi=l
     20 k=(khi+klo+1)/2
     30 kx=2*k
     IF (sil-equ(kx) < 0.0) THEN
       GO TO    40
     ELSE IF (sil-equ(kx) == 0.0) THEN
       GO TO   110
     ELSE
       GO TO    50
     END IF
     40 khi=k
     GO TO 60
     50 klo=k
     60 IF (khi-klo-1 < 0) THEN
       GO TO   120
     ELSE IF (khi-klo-1 == 0) THEN
       GO TO    70
     ELSE
       GO TO    20
     END IF
     70 IF (k == klo) GO TO 80
     k=klo
     GO TO 90
     80 k=khi
     90 klo=khi
     GO TO 30
     110 extrnl(i)=equ(kx-1)
     120 CONTINUE
   END DO
   IF (neqx == 1) CYCLE
   DO  i=1,ngp
     IF (extrnl(i) < 0) GO TO 123
   END DO
   EXIT
   123 l=mxleq
   iend = 0
   CALL READ (*140,*125,eqexin,equ,l,0,i)
   124 DO  i=2,l,2
     equ(i)=IABS(equ(i))
   END DO
   CALL sort (0,0,2,2,equ,l)
   l=l/2
   IF (iend == 1) GO TO 16
   CYCLE
   125 CALL bckrec (eqexin)
   l=i
   iend = 1
   IF (l == 0) GO TO 123
   GO TO 124
 END DO
 135 IF (TYPE /= 3) extrnl(ngp+1)=0
 IF (iend == 0) CALL bckrec (eqexin)
 iend = 1
 GO TO 200
 140 CALL mesage (-61,0,0)
!*****
!     BEGIN STRESS COMPUTATION
!*****
 200 strspt=strspt+1
 IF (strspt == nip**3+1) oldeid=0
 istore=0
 IF (oldeid == 0) istore=1
!*****
!     THERMAL EFFECTS
!*****
 IF (jtemp == -1) GO TO 230
 
!     COMPUTE TEMPERATURE AT THIS POINT
 
 temp=0.0
 DO  i=1,ngp
   temp=temp+esta(ngp+1+i)*gpt(i)
 END DO
 temp=temp-esta(2*ngp+2)
 DO  i=1,6
   sig(i) =temp*esta(2*ngp+2+i)
   csig(i)=ABS(sig(i))
 END DO
 GO TO 250
 230 DO  i=1,6
   sig(i) =0.0
   csig(i)=0.0
 END DO
!*****
!     DISPLACEMENT EFFECTS.  LOOP OVER GRID POINTS.
!*****
 250 DO  i=1,ngp
   j=ivec+iesta(i+1)-1
   k=ngp*2+18*(i-1)+9
   CALL smmats (esta(k),6,3,-2,z(j),3,1,0,sig,csig)
 END DO
 
!     STORE THE GAUSS POINT STRESSES UNTIL WE HAVE THEM ALL
!     NO NEED TO STORE NIP3 + 1ST SINCE CENTROIDAL VALUES WILL BE
!     EXTRAPOLATED. ACTUALLY, NIP3 + 1ST TIMES THRU SIHEX1 AND 2 ARE
!     NOW SUPERFLUOUS
 
 nip3=nip**3
 IF (strspt == nip3+1) GO TO 2611
 ipoint=6*(strspt-1)
 DO  i=1,6
   isub=ipoint+i
   store(isub)=sig(i)
 END DO
 2611 CONTINUE
 
!     IF ALL GAUSS POINT  ARE DONE, EXTRAPOLATE TO GRIDS
 
 IF (oldeid /= 0) RETURN
 
 IF (ngp-20 < 0) THEN
   GO TO  2620
 ELSE
   GO TO  2624
 END IF
 
!     8 GRIDS
 
 2620 IF (nip-3 < 0) THEN
   GO TO  2621
 ELSE IF (nip-3 == 0) THEN
   GO TO  2622
 ELSE
   GO TO  2623
 END IF
 2621 CALL smmats (ex8g2, 9,8,0,store,8,6,0,sigs,csigs)
 GO TO 2632
 2622 CALL smmats (ex8g3, 9,27,0,store,27,6,0,sigs,csigs)
 GO TO 2632
 2623 CALL smmats (ex8g4, 9,64,0,store,64,6,0,sigs,csigs)
 GO TO 2632
 
!     20 OR 32 GRIDS
 
 2624 IF (nip-3 < 0) THEN
   GO TO  2625
 ELSE IF (nip-3 == 0) THEN
   GO TO  2626
 ELSE
   GO TO  2627
 END IF
 2625 CALL smmats (ex20g2,21,8,0,store,8,6,0,sigs,csigs)
 GO TO 2632
 2626 CALL smmats (ex20g3,21,27,0,store,27,6,0,sigs,csigs)
 GO TO 2632
 2627 CALL smmats (ex20g4,21,64,0,store,64,6,0,sigs,csigs)
 2632 RETURN
 
!     JUST FETCH APPROPRIATE SIGS AND LET ROUTINE COMPUTE PRINCIPAL
!     STRESSES AND WRITE( OUT RESULTS
 
 2633 strspt=strspt+1
 ipoint=6*(strspt-nip3-2)
 DO  i=1,6
   isub=ipoint+i
   sig(i) =sigs(isub)
   csig(i)=csigs(isub)
 END DO
 
 isave=strspt
 strspt=strspt-nip3-1
 
!     SKIP PRINCIPAL STRESS COMPUTATIONS IF FINAL STRESS VECTOR
!     WILL BE COMPLEX.
 
 IF (ktype == 2) GO TO 300
!*****
!     SOLVE CUBIC EQUATION FOR PRINCIPAL STRESSES
!*****
 
!         S**3+P*S**2+Q*S+R=0.0
 
!     REF. -- CRC STANDARD MATH TABLES 14TH ED., PP. 392,3
 
 rm=0.0
 DO  i=1,6
   IF (ABS(sig(i)) > rm) rm=ABS(sig(i))
 END DO
 IF (rm <= 0.0) GO TO 267
 thresh=1.0E-5
 264 DO  i=1,6
   IF (ABS(sig(i)/rm) < thresh) sig(i)=0.0
 END DO
 rx = sx/rm
 ry = sy/rm
 rz = sz/rm
 rxy= sxy/rm
 ryz= syz/rm
 rzx= szx/rm
 p  =-rx-ry-rz
 q  = rx*ry+ry*rz+rz*rx-rxy**2-ryz**2-rzx**2
 r  =-(rx*ry*rz+2.0*rxy*ryz*rzx-rx*ryz**2-ry*rzx**2-rz*rxy**2)
 a  = (3.0*q-p**2)/3.0
 b  = (2.0*p**3-9.0*p*q+27.0*r)/27.0
 x  =-a**3/27.0
 IF (x > 1.0E-16) GO TO 270
 
!     CHECK FOR IMAGINARY ROOTS
 
 IF (ABS(x) > rm*1.0E-6) GO TO 265
 
!     CHECK FOR 3 EQUAL ROOTS
 
 IF (ABS(b) > 1.0E-6) GO TO 265
 x  =0.0
 phi=0.0
 GO TO 275
 265 thresh=10.0*thresh
 IF (thresh < 1.1E-3) GO TO 264
 267 sa = 0.0
 sb = 0.0
 sc = 0.0
 GO TO 280
 270 cosphi=-(b/2.0)/SQRT(x)
 ax = ABS(cosphi)
 IF (ax > 0.9999 .AND. ax < 1.0001) cosphi=SIGN(1.0,cosphi)
 IF (ABS(cosphi) > 1.0) GO TO 265
 phi=ACOS(cosphi)
 x =2.0*SQRT(-a/3.0)
 275 sa=(x*COS(phi/3.0)-p/3.0)*rm
 sb=(x*COS(phi/3.0+120.0*dtor)-p/3.0)*rm
 sc=(x*COS(phi/3.0+240.0*dtor)-p/3.0)*rm
 rm=0.0
 DO  i=1,3
   IF (ABS(sigp(i)) > rm) rm=ABS(sigp(i))
 END DO
 DO  i=1,3
   IF (ABS(sigp(i)/rm) < 1.0E-5) sigp(i)=0.0
 END DO
!*****
!     COMPUTE MEAN STRESS OR PRESSURE
!*****
 280 sn=-(sa+sb+sc)/3.0
!*****
!     COMPUTE OCTAHEDRAL SHEAR STRESS
!*****
 so=SQRT(((sa+sn)**2+(sb+sn)**2+(sc+sn)**2)/3.0)
!*****
!     COMPUTE DIRECTION COSINES OF THE PRINCIPAL PLANES
!*****
 rm=1.0E-6
 DO  i=1,3
   IF (sigp(i) == 0.0) GO TO 580
   smat(1,1)= 1.0-sx/sigp(i)
   smat(2,1)=-sxy/sigp(i)
   smat(3,1)=-szx/sigp(i)
   smat(1,2)= smat(2,1)
   smat(2,2)= 1.0-sy/sigp(i)
   smat(3,2)=-syz/sigp(i)
   smat(1,3)= smat(3,1)
   smat(2,3)= smat(3,2)
   smat(3,3)= 1.0-sz/sigp(i)
   CALL saxb (smat(1,1),smat(1,2),DCOS(1,i))
   rx=sadotb(DCOS(1,i),DCOS(1,i))
   j =1
   CALL saxb (smat(1,2),smat(1,3),DCOS(1,i))
   ry=sadotb(DCOS(1,i),DCOS(1,i))
   IF (ry > rx) j=2
   CALL saxb (smat(1,3),smat(1,1),DCOS(1,i))
   rz=sadotb(DCOS(1,i),DCOS(1,i))
   IF (rz > ry .AND. rz > rx) j=3
   p=smat(1,j)
   q=smat(2,j)
   r=smat(3,j)
   IF (j-2 < 0) THEN
     GO TO   450
   ELSE IF (j-2 == 0) THEN
     GO TO   460
   ELSE
     GO TO   470
   END IF
   450 j=2
   GO TO 480
   460 j=3
   GO TO 480
   470 j=1
   480 s=smat(1,j)
   t=smat(2,j)
   v=smat(3,j)
   IF (ABS(q) <= rm) GO TO 500
   rx=v-t*r/q
   IF (ABS(rx) <= rm) GO TO 490
   rz=-(s-t*p/q)/rx
   ry=-(p+r*rz)/q
   485 x=1.0+rz*rz+ry*ry
   DCOS(1,i)=1.0/SQRT(x)
   DCOS(2,i)=ry*DCOS(1,i)
   DCOS(3,i)=rz*DCOS(1,i)
   CYCLE
   490 rx=s-t*p/q
   IF (ABS(rx) <= rm) GO TO 580
   ry=-r/q
   x =1.0+ry*ry
   DCOS(1,i)=0.0
   DCOS(3,i)=1.0/SQRT(x)
   DCOS(2,i)=ry*DCOS(3,i)
   CYCLE
   500 IF (ABS(r) <= rm) GO TO 520
   rz=-p/r
   IF (ABS(t) <= rm) GO TO 510
   ry=-(s-v*p/r)/t
   GO TO 485
   510 IF (ABS(s-v*p/r) <= rm) GO TO 580
   DCOS(1,i)=0.0
   DCOS(2,i)=1.0
   DCOS(3,i)=0.0
   CYCLE
   520 IF (ABS(p) <= rm) GO TO 580
   IF (ABS(v) <= rm) GO TO 530
   rz=-t/v
   x =1.0+rz*rz
   DCOS(1,i)=0.0
   DCOS(2,i)=1.0/SQRT(x)
   DCOS(3,i)=rz*DCOS(2,i)
   CYCLE
   530 IF (ABS(t) <= rm) GO TO 580
   DCOS(1,i)=0.0
   DCOS(2,i)=0.0
   DCOS(3,i)=1.0
   CYCLE
   580 DCOS(1,i)=0.0
   DCOS(2,i)=0.0
   DCOS(3,i)=0.0
 END DO
!*****
!     PUT IT AWAY IN THE STRESS ARRAY
!*****
 300 istrs(1)=iesta(1)
 IF (TYPE == 3) GO TO 310
 istrs(2)=extrnl(strspt)
 GO TO 420
 310 istrs(11)=0
!            1   2   3   4   5   6   7   8   9   10
 GO TO (320,330,320,330,320,330,320,340,350,350,  &
     350,350,360,370,360,370,360,370,360,380, 390),strspt
 320 j=strspt/2+strspt
 GO TO 410
 330 j=(strspt-1)/2+strspt-1
 k=j+3
 GO TO 400
 340 j=(strspt-1)/2+strspt-1
 k=j-9
 GO TO 400
 350 j=(strspt-9)*3+1
 k=j+20
 GO TO 400
 360 j=strspt/2+strspt+2
 GO TO 410
 370 j=(strspt-1)/2+strspt+1
 k=j+3
 GO TO 400
 380 j=(strspt-1)/2+strspt+1
 k=j-9
 GO TO 400
 390 istrs(2)=0
 GO TO 420
 400 istrs(11)=extrnl(k)
 410 istrs(2)=extrnl(j)
 420 stress(      3)=sx
 stress(      4)=sxy
 stress(      5)=sa
 stress(      9)=sn
 stress(     10)=so
 stress(ipts+11)=sy
 stress(ipts+12)=syz
 stress(ipts+13)=sb
 stress(ipts+17)=sz
 stress(ipts+18)=szx
 stress(ipts+19)=sc
 DO  i=1,3
   stress(      5+i)=DCOS(1,i)
   stress(ipts+13+i)=DCOS(2,i)
   stress(ipts+19+i)=DCOS(3,i)
 END DO
 strspt=isave
 IF (nchk <= 0) GO TO 960
 
!   . CHECK PRECISION...
 
 kk = 0
 CALL sdrchk (sig,csig,6,kk)
 
 IF (kk == 0) GO TO 960
 
!   . LIMITS EXCEEDED...
 
 jj = 0
 ifrvec(1) = typ(1)
 IF (TYPE == 1) ifrvec(2) = typ(2)
 IF (TYPE == 2) ifrvec(2) = typ(3)
 IF (TYPE == 3) ifrvec(2) = typ(4)
 ifrvec(3) = iesta(1)
 ifrvec(4) = istrs(2)
 ifrvec(5) = istrs(11)
 IF (TYPE /= 3) ifrvec(5) = -1
 
 IF (lsub == isub .AND. frlast(1) == frtmei(1) .AND.  &
     lld == ild  .AND. frlast(2) == frtmei(2)) GO TO 930
 
 lsub = isub
 lld = ild
 frlast(1) = frtmei(1)
 frlast(2) = frtmei(2)
 jj = 1
 CALL page1
 
 910 CALL sd2rhd (ishd,jj)
 line = line + 1
 WRITE  (nout,920)
 920 FORMAT (7X,4HTYPE,5X,3HEID,4X,4HGRD1,4X,4HGRD2,5X,2HSX,5X,  &
     2HSY,5X,2HSZ,4X,3HSXY,4X,3HSYZ,4X,3HSZX)
 GO TO 940
 
 930 IF (eject(2) /= 0) GO TO 910
 940 WRITE  (nout,950) ifrvec
 950 FORMAT (1H0,3X,2A4,i7,2I8,6F7.1)
 960 CONTINUE
 RETURN
END SUBROUTINE sihex2
